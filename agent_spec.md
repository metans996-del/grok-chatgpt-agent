# Agent Spec — «Полуавтономный самоподлежающийся агент»

## Цель
Агент предлагает изменения к коду, тестирует их в изолированной песочнице, создаёт pull request с описанием и результатами тестов, предлагает идеи для монетизации и готовит материалы. Все критические шаги (merge, платежи, публикация в прод) требуют человеческого подтверждения.

## Функции (разрешённые)
- Читать репозиторий и issues.
- Генерировать патчи (кодтестыдокументация).
- Запускать unitintegration тесты в Docker-песочнице.
- Выполнять статический анализ (flake8, mypy, bandit).
- Создавать ветку и PR с отчётом.
- Формировать маркетинговые материалы и карточки товара (подготовка, не публикация).
- Писать отчёты по ROIпрогнозам.

## Запрещённые действия
- Автоматический merge PR без одобрения человека.
- Автоматические денежные переводы.
- Изменение ключей доступа без подтверждения.
- Рассылка спама, обход правил платформ.

## Политика подтверждений
- Любая операция, влияющая на финансы или production, требует одобрения через UI (TelegramВКвеб) с 2FA.
- PR создаются автоматически, merge — вручную.
- Логи действий неизменяемы, доступны для аудита.

## Тестирование и песочница
- Все изменения запускаются в Docker-контейнере CPURAM лимиты, network disabled по умолчанию.
- Агент формирует отчёт coverage, время, ошибки.
- При падении тестов PR помечается `tests_failed true`.

## Recovery & Rollback
- Для каждого принятого PR создаётся точка отката (git tag + snapshot docker image).
- Есть кнопка «Rollback» в UI.

## Секреты
- GitHub token минимальные права (создать ветку, PR).
- Telegram token и ADMIN_CHAT_ID.
- Другие API ключи — в GitHub Secrets.
